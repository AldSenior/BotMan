== Background

В условиях растущей популярности мессенджеров и автоматизации клиентских коммуникаций, малые и средние бизнесы ищут простые инструменты для общения с клиентами. Однако большинство существующих решений требует навыков программирования или интеграции с внешними сервисами.

Данный проект предлагает no-code платформу, фокусирующуюся на Telegram, которая позволяет пользователям:

- создавать и настраивать собственных ботов,
- настраивать автоматические рассылки,
- просматривать историю переписок с ботами,
- а также вручную отправлять сообщения от имени бота для прямого общения с клиентами.

Цель — упростить процесс создания автоматизированных коммуникаций без необходимости писать код.

== Requirements

=== Must Have

- Пользователь может авторизоваться в системе.
- Пользователь может создать Telegram-бота через BotFather и подключить его к платформе.
- Пользователь может настраивать базовые сценарии общения (триггер → ответ).
- Пользователь может создавать и отправлять рассылки через Telegram.
- Сохраняется история отправленных сообщений.
- Пользователь видит список всех своих ботов.
- Пользователь может просматривать переписки пользователей с его ботами.
- Возможность отправлять сообщения от имени бота вручную (например, через чат-интерфейс).

=== Should Have

- Простая визуальная настройка сценариев общения (flow-based редактор).
- Фильтрация и поиск по истории сообщений.
- Поддержка разных ролей (например, менеджер и админ).
- Отображение статистики рассылок (сколько отправлено, сколько прочитано, и т.д.).

=== Could Have

- Импорт контактов для рассылки.
- Группировка пользователей по сегментам.
- Отложенные рассылки и планировщик.

=== Won’t Have (в MVP)

- Поддержка других мессенджеров (WhatsApp, Viber, Email).
- Расширенная логика с условиями, ветвлениями и интеграциями с внешними API.

== Method

Система построена по микросервисному подходу с разделением на frontend и backend, соединённых через REST API (или LiveView/Channels по необходимости). Все запросы к Telegram API происходят через backend, что позволяет централизовать обработку логики и обеспечить безопасность токенов.

## [plantuml, architecture, svg]

@startuml
package "Client" {
[Browser UI\n(Next.js + Tailwind)]
}

package "Server" {
[Phoenix API\n(Elixir)]
[Bot Handler\n(telegram bot via Phoenix Task/GenServer)]
[Database\n(PostgreSQL)]
[Webhook Processor]
}

package "External" {
[Telegram API]
[Render/Docker\n(Deployment)]
}

Browser UI --> Phoenix API : REST/GraphQL\nAuth, Bot Config
Phoenix API --> Bot Handler : Create/update bot logic
Telegram API --> Webhook Processor : Incoming Messages
Webhook Processor --> Phoenix API : Forward to logic
Phoenix API --> Database : All reads/writes
Phoenix API --> Telegram API : Send messages
@enduml

---

Система включает следующие ключевые компоненты:

- **Browser UI (Next.js)** — интерфейс для создания и управления ботами, рассылками и просмотром истории.
- **Phoenix API** — REST/GraphQL сервер для обработки бизнес-логики, работы с базой и Telegram API.
- **Bot Handler** — обрабатывает команды, рассылки и может работать как GenServer или Task Supervisor.
- **Webhook Processor** — приём входящих сообщений от Telegram и маршрутизация в Bot Handler.
- **PostgreSQL** — хранение всех данных (пользователи, боты, сообщения, сценарии).
- **Telegram API** — внешний канал, куда и откуда идут сообщения.
- **Docker/Render** — среда деплоя.
